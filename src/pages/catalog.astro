---
export const prerender = false; // Habilitar SSR para contenido din√°mico

import Layout from '../layouts/Layout.astro';
import Button from '@components/Button.jsx';
import StyleCard from '@components/StyleCard.jsx';
import { getGeneratedImages } from '../lib/galleryService.js';

// Obtener las im√°genes generadas din√°micamente
const allImages = await getGeneratedImages();

// Obtener las 3 √∫ltimas im√°genes para el carousel
const latestImages = allImages
  .slice(0, 3)
  .map(img => img.imageUrl || img.url);

// Si no hay suficientes im√°genes, usar im√°genes de placeholder
const carouselImages = latestImages.length > 0 
  ? latestImages
  : [
    'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
    'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
    'https://images.unsplash.com/photo-1533636721434-0e2d61030955?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80'
  ];

// Filtrar im√°genes por estilo
const quepasoImages = allImages.filter(img => 
	img.generation?.styleId === 'que-paso-ayer-fiesta' || 
	!img.generation?.styleId // Para compatibilidad con im√°genes antiguas
);
const chibiImages = allImages.filter(img => 
	img.generation?.styleId === 'chibi-sticker'
);
const figureImages = allImages.filter(img => 
	img.generation?.styleId === 'figure-collector'
);
const buzzCutImages = allImages.filter(img => 
	img.generation?.styleId === 'buzz-cut-street'
);
const filmNoirImages = allImages.filter(img => 
	img.generation?.styleId === 'film-noir-portrait'
);
const editorialPortraitImages = allImages.filter(img => 
	img.generation?.styleId === 'editorial-portrait'
);
const yarnDollImages = allImages.filter(img => 
	img.generation?.styleId === 'yarn-doll'
);

// Datos de los estilos disponibles
const styles = [
	{
		id: 'que-paso-ayer',
		title: '¬øQu√© pas√≥ ayer?',
		description: 'Revive las aventuras m√°s descontroladas de la pel√≠cula "¬øQu√© Pas√≥ Ayer?". Genera im√°genes junto a tu celebridad favorita en una fiesta √©pica.',
		images: quepasoImages.slice(0, 3).map(img => img.imageUrl || img.url) || carouselImages,
		totalGenerated: quepasoImages.length
	},
	{
		id: 'chibi-sticker',
		title: '‚ú® Chibi Sticker',
		description: "Convierte tu foto en 9 adorables stickers chibi kawaii con diferentes expresiones usando IA. El pack perfecto para cualquier emoci√≥n.",
		images: chibiImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1535295972055-1c762f4483e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: chibiImages.length
	},
	{
		id: 'figure-collector',
		title: 'üèÜ Figure Collector',
		description: "Crea figuras coleccionables profesionales escala 1/7 con ambiente realista de computadora, pantalla ZBrush y packaging estilo BANDAI. Solo necesitas una foto.",
		images: figureImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1535295972055-1c762f4483e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: figureImages.length
	},
	{
		id: 'buzz-cut',
		title: '‚úÇÔ∏è Buzz Cut Street',
		description: "Transforma cualquier peinado en un fresh buzz cut con estilo urbano cinematic. Luces neon, ambiente nocturno y calidad cinematogr√°fica profesional.",
		images: buzzCutImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1552374196-c4e7ffc6e126?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: buzzCutImages.length
	},
	{
		id: 'film-noir',
		title: 'üìú Retrato Siglo XIX',
		description: "Retrato hist√≥rico del siglo XIX americano con estilo daguerrotipo/tintype, ambiente victoriano elegante y textura vintage de los a√±os 1800s. Sepia o blanco y negro.",
		images: filmNoirImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1485199433301-2afab2c3e1d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: filmNoirImages.length
	},
	{
		id: 'editorial-portrait',
		title: 'üì∏ Editorial Portrait B&W',
		description: "Retrato editorial de alta resoluci√≥n en blanco y negro con gradiente suave, film grain delicado y est√©tica de fine art photography. Minimalismo elegante y atemporal.",
		images: editorialPortraitImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: editorialPortraitImages.length
	},
	{
		id: 'yarn-doll',
		title: 'üß∂ Yarn Doll Crochet',
		description: "Mu√±eco de crochet tejido a mano estilo chibi amigurumi. Textura de lana suave con puntadas visibles, colores pastel kawaii y proporciones adorables. ¬°Handmade charm!",
		images: yarnDollImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1515378960530-7c0da6231fb1?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1516975080664-ed2fc6a32937?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: yarnDollImages.length
	}
];

---

<Layout 
	title="Cat√°logo AI - Universidad Tom√°s Fr√≠as" 
	description="Explora nuestra colecci√≥n de estilos AI para generar im√°genes incre√≠bles. Celebridades, pel√≠culas, ubicaciones y filtros cinematogr√°ficos."
>
	<!-- Header del Cat√°logo -->
	<section class="bg-primary-800 py-20">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-white">
			<h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-6">
				<span class="text-secondary-400">Cat√°logo</span> de Estilos AI
			</h1>
			<p class="text-xl lg:text-2xl mb-8 max-w-3xl mx-auto text-primary-100">
				Explora nuestra colecci√≥n de estilos AI y selecciona el que m√°s te guste. 
				Cada estilo te llevar√° a la p√°gina de generaci√≥n personalizada.
			</p>
		</div>
	</section>

	<!-- Galer√≠a de Im√°genes AI -->
	<section class="py-16 bg-accent-50">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
				{styles.map((style) => (
					<StyleCard
						id={style.id}
						title={style.title}
						description={style.description}
						images={style.images}
						totalGenerated={style.totalGenerated}
						client:load
					/>
				))}
			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer class="bg-accent-900 text-white py-12">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="flex flex-col md:flex-row justify-between items-center">
				<div class="mb-4 md:mb-0">
					<h3 class="text-lg font-semibold text-secondary-400">AI Image Catalog</h3>
					<p class="text-accent-300">Universidad Tom√°s Fr√≠as - Ingenier√≠a Inform√°tica</p>
				</div>
				<div class="flex gap-4">
					<Button variant="ghost" size="md" href="/" className="text-accent-300 hover:text-white transition-colors">Inicio</Button>
					<Button variant="ghost" size="md" href="/catalog" className="text-accent-300 hover:text-white transition-colors">Cat√°logo</Button>
					<Button variant="ghost" size="md" href="/generate" className="text-accent-300 hover:text-white transition-colors">Generar</Button>
				</div>
			</div>
			<div class="border-t border-accent-700 mt-8 pt-8 text-center text-accent-400">
				<p>&copy; 2025 Universidad Tom√°s Fr√≠as - Ingenier√≠a Inform√°tica. Todos los derechos reservados.</p>
			</div>
		</div>
	</footer>
</Layout>