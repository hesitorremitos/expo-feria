---
export const prerender = false; // Habilitar SSR para contenido dinámico

import Layout from '../layouts/Layout.astro';
import Button from '@components/Button.jsx';
import StyleCard from '@components/StyleCard.jsx';
import { getGeneratedImages } from '../lib/galleryService.js';

// Obtener las imágenes generadas dinámicamente
const allImages = await getGeneratedImages();

// Obtener las 3 últimas imágenes para el carousel
const latestImages = allImages
  .slice(0, 3)
  .map(img => img.imageUrl || img.url);

// Si no hay suficientes imágenes, usar imágenes de placeholder
const carouselImages = latestImages.length > 0 
  ? latestImages
  : [
    'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
    'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80',
    'https://images.unsplash.com/photo-1533636721434-0e2d61030955?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=80'
  ];

// Filtrar imágenes por estilo
const quepasoImages = allImages.filter(img => 
	img.generation?.styleId === 'que-paso-ayer-fiesta' || 
	!img.generation?.styleId // Para compatibilidad con imágenes antiguas
);
const chibiImages = allImages.filter(img => 
	img.generation?.styleId === 'chibi-sticker'
);
const figureImages = allImages.filter(img => 
	img.generation?.styleId === 'figure-collector'
);
const buzzCutImages = allImages.filter(img => 
	img.generation?.styleId === 'buzz-cut-street'
);
const filmNoirImages = allImages.filter(img => 
	img.generation?.styleId === 'film-noir-portrait'
);
const editorialPortraitImages = allImages.filter(img => 
	img.generation?.styleId === 'editorial-portrait'
);
const yarnDollImages = allImages.filter(img => 
	img.generation?.styleId === 'yarn-doll'
);
const pencilSketchImages = allImages.filter(img => 
	img.generation?.styleId === 'pencil-sketch'
);
const instagramChibiImages = allImages.filter(img => 
	img.generation?.styleId === 'instagram-chibi'
);
const legoCollectionImages = allImages.filter(img => 
	img.generation?.styleId === 'lego-collection'
);
const ghibliStyleImages = allImages.filter(img => 
	img.generation?.styleId === 'ghibli-style'
);
const polaroidChibiImages = allImages.filter(img => 
	img.generation?.styleId === 'polaroid-chibi'
);
const ghibliClassicImages = allImages.filter(img => 
	img.generation?.styleId === 'ghibli-classic'
);

// Datos de los estilos disponibles
const styles = [
	{
		id: 'que-paso-ayer',
		title: '¿Qué pasó ayer?',
		description: 'Revive las aventuras más descontroladas de la película "¿Qué Pasó Ayer?". Genera imágenes junto a tu celebridad favorita en una fiesta épica.',
		images: quepasoImages.slice(0, 3).map(img => img.imageUrl || img.url) || carouselImages,
		totalGenerated: quepasoImages.length
	},
	{
		id: 'chibi-sticker',
		title: '✨ Chibi Sticker',
		description: "Convierte tu foto en 9 adorables stickers chibi kawaii con diferentes expresiones usando IA. El pack perfecto para cualquier emoción.",
		images: chibiImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1535295972055-1c762f4483e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: chibiImages.length
	},
	{
		id: 'figure-collector',
		title: '🏆 Figure Collector',
		description: "Crea figuras coleccionables profesionales escala 1/7 con ambiente realista de computadora, pantalla ZBrush y packaging estilo BANDAI. Solo necesitas una foto.",
		images: figureImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1513475382585-d06e58bcb0e0?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1535295972055-1c762f4483e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: figureImages.length
	},
	{
		id: 'buzz-cut',
		title: '✂️ Buzz Cut Street',
		description: "Transforma cualquier peinado en un fresh buzz cut con estilo urbano cinematic. Luces neon, ambiente nocturno y calidad cinematográfica profesional.",
		images: buzzCutImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1552374196-c4e7ffc6e126?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: buzzCutImages.length
	},
	{
		id: 'film-noir',
		title: '📜 Retrato Siglo XIX',
		description: "Retrato histórico del siglo XIX americano con estilo daguerrotipo/tintype, ambiente victoriano elegante y textura vintage de los años 1800s. Sepia o blanco y negro.",
		images: filmNoirImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1485199433301-2afab2c3e1d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: filmNoirImages.length
	},
	{
		id: 'editorial-portrait',
		title: '📸 Editorial Portrait B&W',
		description: "Retrato editorial de alta resolución en blanco y negro con gradiente suave, film grain delicado y estética de fine art photography. Minimalismo elegante y atemporal.",
		images: editorialPortraitImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: editorialPortraitImages.length
	},
	{
		id: 'yarn-doll',
		title: '🧶 Yarn Doll Crochet',
		description: "Muñeco de crochet tejido a mano estilo chibi amigurumi. Textura de lana suave con puntadas visibles, colores pastel kawaii y proporciones adorables. ¡Handmade charm!",
		images: yarnDollImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1515378960530-7c0da6231fb1?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1516975080664-ed2fc6a32937?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1489599849927-2ee91cede3ba?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: yarnDollImages.length
	},
	{
		id: 'pencil-sketch',
		title: '✏️ Pencil Sketch',
		description: "Boceto realista a lápiz dibujado a mano con textura de papel auténtica, técnicas de sombreado profesional y trazos de grafito. Arte clásico atemporal.",
		images: pencilSketchImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1513519245088-0e12902e35ca?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1460661419201-fd4cecdf8a8b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1544005313-94ddf0286df2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: pencilSketchImages.length
	},
	{
		id: 'instagram-chibi',
		title: '📱 Instagram Chibi 3D',
		description: "Chibi 3D adorable sentado en marco de Instagram con render profesional, colores pastel y estética moderna de redes sociales. Perfecto para avatares.",
		images: instagramChibiImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1611162617474-5b21e879e113?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1611605698335-8b1569810432?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1614680376593-902f74cf0d41?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: instagramChibiImages.length
	},
	{
		id: 'lego-collection',
		title: '🧸 LEGO Collection',
		description: "Minifigura LEGO auténtica en vitrina profesional con animal acompañante, base con studs reales y calidad de colección premium. Arte de ladrillos.",
		images: legoCollectionImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1587654780291-39c9404d746b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1515488764276-beab7607c1e6?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: legoCollectionImages.length
	},
	{
		id: 'ghibli-style',
		title: '🎨 Ghibli Style',
		description: "Transformación auténtica a arte anime Studio Ghibli con acuarela nostálgica, ojos expresivos y la mágica estética de Hayao Miyazaki. Calidad cinematográfica.",
		images: ghibliStyleImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1578632292335-df3abbb0d586?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1618336753974-aae8e04506aa?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1545165883-be7f9e0e9e1b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: ghibliStyleImages.length
	},
	{
		id: 'polaroid-chibi',
		title: '📷 Polaroid Chibi',
		description: "Chibi 3D adorable literalmente saliendo de una Polaroid vintage con efecto de profundidad único. Breaking the 4th wall con render profesional tipo Pixar.",
		images: polaroidChibiImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1516541196182-6bdb0516ed27?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1526413232644-8a40f03cc03b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1492112007959-c35ae067c37b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: polaroidChibiImages.length
	},
	{
		id: 'ghibli-classic',
		title: '🎨 Ghibli Classic',
		description: "Redibuja tu foto en el icónico estilo anime de Studio Ghibli. Simple, auténtico y atemporal - captura la magia de Miyazaki.",
		images: ghibliClassicImages.slice(0, 3).map(img => img.imageUrl || img.url) || [
			'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1618336753974-aae8e04506aa?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80',
			'https://images.unsplash.com/photo-1545165883-be7f9e0e9e1b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'
		],
		totalGenerated: ghibliClassicImages.length
	}
];

---

<Layout 
	title="Catálogo AI - Universidad Tomás Frías" 
	description="Explora nuestra colección de estilos AI para generar imágenes increíbles. Celebridades, películas, ubicaciones y filtros cinematográficos."
>
	<!-- Header del Catálogo -->
	<section class="bg-primary-800 py-20">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center text-white">
			<h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold mb-6">
				<span class="text-secondary-400">Catálogo</span> de Estilos AI
			</h1>
			<p class="text-xl lg:text-2xl mb-8 max-w-3xl mx-auto text-primary-100">
				Explora nuestra colección de estilos AI y selecciona el que más te guste. 
				Cada estilo te llevará a la página de generación personalizada.
			</p>
		</div>
	</section>

	<!-- Galería de Imágenes AI -->
	<section class="py-16 bg-accent-50">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
				{styles.map((style) => (
					<StyleCard
						id={style.id}
						title={style.title}
						description={style.description}
						images={style.images}
						totalGenerated={style.totalGenerated}
						client:load
					/>
				))}
			</div>
		</div>
	</section>

	<!-- Footer -->
	<footer class="bg-accent-900 text-white py-12">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="flex flex-col md:flex-row justify-between items-center">
				<div class="mb-4 md:mb-0">
					<h3 class="text-lg font-semibold text-secondary-400">AI Image Catalog</h3>
					<p class="text-accent-300">Universidad Tomás Frías - Ingeniería Informática</p>
				</div>
				<div class="flex gap-4">
					<Button variant="ghost" size="md" href="/" className="text-accent-300 hover:text-white transition-colors">Inicio</Button>
					<Button variant="ghost" size="md" href="/catalog" className="text-accent-300 hover:text-white transition-colors">Catálogo</Button>
					<Button variant="ghost" size="md" href="/generate" className="text-accent-300 hover:text-white transition-colors">Generar</Button>
				</div>
			</div>
			<div class="border-t border-accent-700 mt-8 pt-8 text-center text-accent-400">
				<p>&copy; 2025 Universidad Tomás Frías - Ingeniería Informática. Todos los derechos reservados.</p>
			</div>
		</div>
	</footer>
</Layout>